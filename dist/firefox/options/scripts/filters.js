import browser from"webextension-polyfill";import{defaultLLMSites,STORAGE_KEYS}from"../../config.js";const{BLOCKED_SITES}=STORAGE_KEYS;let blockedSitesTextarea,saveButton,statusDiv,loadedSettings=null;export function init(){console.log("General initialising"),blockedSitesTextarea=document.getElementById("blockedSites"),saveButton=document.getElementById("save-button"),statusDiv=document.getElementById("status"),loadSettings(),saveButton.addEventListener("click",saveSettings)}export function cleanup(){console.log("Filters cleaning up"),saveButton?.removeEventListener("click",saveSettings)}const loadSettings=()=>{browser.storage.sync.get(Object.values(STORAGE_KEYS)).then(t=>{loadedSettings=t,console.log("Filters loading settings: ",t);const e=t[BLOCKED_SITES];blockedSitesTextarea.value=e&&e.length>0?e.join("\n"):defaultLLMSites.join("\n")}).catch(t=>{console.error("Error loading settings:",t),statusDiv.textContent="Error loading settings.",statusDiv.style.color="red"})},saveSettings=()=>{loadedSettings[BLOCKED_SITES]=blockedSitesTextarea.value.split("\n").map(t=>t.trim()).filter(t=>""!==t),console.log("Saving settings:",loadedSettings),browser.storage.sync.set(loadedSettings).then(()=>{statusDiv.textContent="Settings saved!",statusDiv.style.color="green",setTimeout(()=>{statusDiv.textContent=""},3e3)}).catch(t=>{console.error("Error saving settings:",t),statusDiv.textContent="Error saving settings.",statusDiv.style.color="red"})};